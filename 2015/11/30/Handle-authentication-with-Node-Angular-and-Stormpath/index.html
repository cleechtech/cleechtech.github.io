
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="El Blogo de Connor">
    <title>Handle authentication with Node, Angular and Stormpath - El Blogo de Connor</title>
    <meta name="author" content="Connor Leech">
    
    
    <meta name="description" content="Final SOURCE CODE
Set up projectStormpath is a service that handles user authentication and authorization for you. We are going to integrate Stormpath user management into a very lightweight MEAN stac">
<meta property="og:type" content="blog">
<meta property="og:title" content="Handle authentication with Node, Angular and Stormpath">
<meta property="og:url" content="http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/index.html">
<meta property="og:site_name" content="El Blogo de Connor">
<meta property="og:description" content="Final SOURCE CODE
Set up projectStormpath is a service that handles user authentication and authorization for you. We are going to integrate Stormpath user management into a very lightweight MEAN stac">
<meta property="og:image" content="http://i.imgur.com/SSnbmVQ.png">
<meta property="og:image" content="http://i.imgur.com/js1Xx9v.png">
<meta property="og:image" content="http://i.imgur.com/VN1tFsl.png">
<meta property="og:updated_time" content="2015-12-14T22:34:21.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Handle authentication with Node, Angular and Stormpath">
<meta name="twitter:description" content="Final SOURCE CODE
Set up projectStormpath is a service that handles user authentication and authorization for you. We are going to integrate Stormpath user management into a very lightweight MEAN stac">
<meta name="twitter:creator" content="@realjasonshark">
    
        <meta rel="publisher" content="https://plus.google.com/+ConnorLeech"/>
    
    
    
        <meta property="og:image" content="http://www.gravatar.com/avatar/88ce5a1f961832585f329292d22451fc?s=640"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/font-awesome.css" type="text/css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox.css" type="text/css">
    <link rel="stylesheet" href="/assets/css/jquery.fancybox-thumbs.css" type="text/css">
    <link rel="stylesheet" href="/assets/css/tranquilpeak.css" type="text/css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-70809574-1']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
    

<header id="header" data-behavior="3">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">El Blogo de Connor</a>
    </h1>
    
        
            <a  class="header-right-picture "
                href="/#about">
        
        
            <img class="header-picture" src="http://www.gravatar.com/avatar/88ce5a1f961832585f329292d22451fc?s=90"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->


    

<nav id="sidebar" data-behavior="3">
    
        <div class="sidebar-profile">
            <a href="/#about">
                    <img class="sidebar-profile-picture" src="http://www.gravatar.com/avatar/88ce5a1f961832585f329292d22451fc?s=110"/>
            </a>
            <span class="sidebar-profile-name">Connor Leech</span>
        </div>
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/ "
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/all-tags"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link "
                         href="/#about"
                        
                    >
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://github.com/cleechtech" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="http://stackoverflow.com/users/2031033/connor-leech" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-stack-overflow"></i>
                    <span class="sidebar-button-desc">Stack Overflow</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://twitter.com/realjasonshark" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
                    <span class="sidebar-button-desc">Twitter</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="https://www.linkedin.com/in/connorleech" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
                    <span class="sidebar-button-desc">LinkedIn</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a  class="sidebar-button-link " href="mailto:connorleech@gmail.com" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
                    <span class="sidebar-button-desc">Mail</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="3"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            Handle authentication with Node, Angular and Stormpath
        </h1>
    
    <div class="post-meta">
    <time itemprop="datePublished" content="Mon Nov 30 2015 11:59:01 GMT-0800">
	
		    Nov 30, 2015
    	
    </time>
    
</div>
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>Final <a href="https://github.com/cleechtech/node-angular-stormpath" target="_blank" rel="external">SOURCE CODE</a></p>
<h2 id="Set_up_project">Set up project</h2><p>Stormpath is a service that handles user authentication and authorization for you. We are going to integrate Stormpath user management into a very lightweight MEAN stack starter template. First we’re going to clone the starter project which you can view <a href="https://github.com/cleechtech/mean-starter" target="_blank" rel="external">here</a>.<br><a id="more"></a><br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="keyword">clone</span> <span class="title">git</span>@github.com:cleechtech/mean-starter.git <span class="keyword">node</span><span class="identifier"></span><span class="title">-angular-stormpath</span></span><br></pre></td></tr></table></figure></p>
<p>This command clones the starter template into a folder named “node-angular-stormpath”. The starter template is set up with MongoDB, so open a new tab and run <code>mongod</code> in that window so MongoDB is ready on your machine.</p>
<p>Next up install dependencies and start the Node.js server.</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd <span class="keyword">node</span><span class="identifier"></span><span class="title">-angular-stormpath</span></span><br><span class="line">$ npm i &amp;&amp; nodemon server</span><br></pre></td></tr></table></figure>
<h2 id="Register_for_Stormpath">Register for Stormpath</h2><p>So here I’m following parts of the <a href="https://stormpath.com/blog/angular-node-15-minutes/" target="_blank" rel="external">official tutorial</a>.</p>
<p>Either <a href="https://api.stormpath.com/register" target="_blank" rel="external">register</a> for a new account or <a href="https://api.stormpath.com/login" target="_blank" rel="external">login</a> if you already have one. The dashboard will look like this. Click “Create API Key”.</p>
<p><img src="http://i.imgur.com/SSnbmVQ.png" alt="Stormpath dashboard"></p>
<p>So once you create a new API key you must download a file with your credentials. This is the message from Stormpath</p>
<blockquote>
<p>By creating a new API Key, you will be prompted to download a file containing both your API Key ID, and the secret key</p>
<p>Make sure you place this file in a safe location so you do not lose it. You will not be able to download this file again. If you lose the file, you will have to delete the API key and create a new one.</p>
</blockquote>
<p>I saved the file to my desktop. Next up go to the “Applications” tab and click “Create Application”.</p>
<p><img src="http://i.imgur.com/js1Xx9v.png" alt="Create an application"></p>
<p>Click the application you created from the list and get the “HREF”. Next configure environment variables on your machine:</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">export</span> STOR<span class="built_in">MPATH_CLIENT_APIKEY_ID</span>=xxxx</span><br><span class="line">$ <span class="keyword">export</span> STOR<span class="built_in">MPATH_CLIENT_APIKEY_SECRET</span>=xxxx</span><br><span class="line">$ <span class="keyword">export</span> STOR<span class="built_in">MPATH_APPLICATION_HREF</span>=xxxx</span><br></pre></td></tr></table></figure>
<p>To view your environment variables on mac you can use <code>$ printenv</code> or <code>$ printenv STORMPATH_CLIENT_APIKEY_ID</code>. </p>
<p>We will have to do this again when shipping to production, though that will look a bit different. Configuring environment variables on heroku looks like <code>$ heroku config:set STORMPATH_CLIENT_APIKEY_ID=xxxx</code>.</p>
<p>Last but not least you must set a “default account store” in order to avoid <a href="https://github.com/stormpath/express-stormpath/issues/212" target="_blank" rel="external">this error</a>.</p>
<p><img src="http://i.imgur.com/VN1tFsl.png" alt="Set a default account store"></p>
<h2 id="Start_coding">Start coding</h2><p>After we set up Stormpath for our environment install the stormpath npm package into our project:</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm <span class="tag">i</span> --save express-stormpath</span><br></pre></td></tr></table></figure>
<p>Then init the stormpath in <strong>server.js</strong> after the express config block:</p>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// STORMPATH CONFIG</span></span><br><span class="line"><span class="built_in">var</span> stormpath = <span class="keyword">require</span>(<span class="string">'express-stormpath'</span>);</span><br><span class="line"><span class="built_in">var</span> path = <span class="keyword">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line">app<span class="built_in">.</span>use(stormpath<span class="built_in">.</span>init(app, &#123;</span><br><span class="line">	website: <span class="literal">true</span>,</span><br><span class="line">	web: &#123;</span><br><span class="line">		spaRoot: path<span class="built_in">.</span><span class="keyword">join</span>(__dirname, <span class="string">'public'</span>, <span class="string">'index.html'</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<h2 id="Protect_a_route">Protect a route</h2><p>Go into <strong>server/routes.js</strong> and add some API routes.</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">module.exports = <span class="function"><span class="keyword">function</span><span class="params">(app)</span></span>&#123;	</span><br><span class="line"></span><br><span class="line">	apiRouter.<span class="keyword">get</span>(<span class="string">'/test'</span>, stormpath.apiAuthenticationRequired, <span class="function"><span class="keyword">function</span><span class="params">(req, res)</span></span>&#123;</span><br><span class="line">		res.send(<span class="string">'Does not pass the test!'</span>);</span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	apiRouter.<span class="keyword">get</span>(<span class="string">'/test2'</span>, <span class="function"><span class="keyword">function</span><span class="params">(req, res)</span></span>&#123;</span><br><span class="line">		res.send(<span class="string">'Passes the test!'</span>);</span><br><span class="line">	&#125;);</span><br><span class="line">	</span><br><span class="line">	...</span><br></pre></td></tr></table></figure>
<p>When you try to hit <code>http://localhost:3000/api/test</code> you will get a JSON error:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="rules">&#123;</span><br><span class="line"><span class="rule"><span class="attribute">error</span>:<span class="value"> <span class="string">"Invalid API credentials."</span></span><br><span class="line"></span></span></span>&#125;</span><br></pre></td></tr></table></figure>
<p>But when you go to <code>http://localhost:3000/api/test2</code> you will see the text “Passes the test!”. Just like that we have endpoint protection for our API.</p>
<h2 id="Log_users_in">Log users in</h2><p>Now we will transition to client side. We are going to use bower. It should really be part of the starter template but whatever, here it goes:</p>
<figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ </span>touch .bowerrc</span><br></pre></td></tr></table></figure>
<p><strong>.bowerrc</strong> then looks like:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "<span class="attribute">directory</span>": <span class="value"><span class="string">"public/bower_components"</span></span><br><span class="line"></span>&#125;</span><br></pre></td></tr></table></figure>
<p>Then run our bower commands:</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="keyword">bower </span>init</span><br><span class="line">$ <span class="keyword">bower </span>install --save stormpath-sdk-angularjs</span><br></pre></td></tr></table></figure>
<p>Add these scripts to index.html:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"bower_components/stormpath-sdk-angularjs/dist/stormpath-sdk-angularjs.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">script</span> <span class="attribute">src</span>=<span class="value">"bower_components/stormpath-sdk-angularjs/dist/stormpath-sdk-angularjs.tpls.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="title">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>And add the modules to our angular app:</p>
<figure class="highlight ocaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var app = angular.<span class="keyword">module</span>(<span class="symbol">'mean</span>-boilerplate', [</span><br><span class="line">	<span class="symbol">'ui</span>.router',</span><br><span class="line">	<span class="symbol">'stormpath'</span>,</span><br><span class="line">	<span class="symbol">'stormpath</span>.templates'</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<p>Then configure the <code>$stormpath</code> module in a run block:</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">app.run(<span class="keyword">function</span>(<span class="variable">$stormpath</span>)&#123;</span><br><span class="line">  <span class="variable">$stormpath</span>.uiRouter(&#123;</span><br><span class="line">    loginState: <span class="string">'login'</span>,</span><br><span class="line">    defaultPostLoginState: <span class="string">'main'</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>This sends users to the “main” view after they log in and to the “login” view if they try and access a protected route when not logged in.</p>
<p>Create a navbar in <strong>public/templates/navbar.html</strong>:</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul class=<span class="string">"nav navbar-nav"</span>&gt;</span><br><span class="line">  &lt;li ng-repeat=<span class="string">"item in menu"</span> ng-class=<span class="string">"&#123;active: isActive(item.link)&#125;"</span>&gt;</span><br><span class="line">      &lt;a ng-href=<span class="string">"&#123;&#123;item.link&#125;&#125;"</span>&gt;&#123;&#123;item.title&#125;&#125;&lt;/a&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">  &lt;li<span class="instruction"> if-user </span>ng-class=<span class="string">"&#123;active: isActive('/profile')&#125;"</span>&gt;</span><br><span class="line">      &lt;a ng-href=<span class="string">"/profile"</span>&gt;Profile&lt;/a&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">  &lt;li<span class="instruction"> if-not-user </span>ng-class=<span class="string">"&#123;active: isActive('/register')&#125;"</span>&gt;</span><br><span class="line">      &lt;a ui-sref=<span class="string">"register"</span>&gt;Register&lt;/a&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">  &lt;li<span class="instruction"> if-not-user </span>ng-class=<span class="string">"&#123;active: isActive('/login')&#125;"</span>&gt;</span><br><span class="line">      &lt;a ui-sref=<span class="string">"login"</span>&gt;Login&lt;/a&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">  &lt;li<span class="instruction"> if-user </span>ng-class=<span class="string">"&#123;active: isActive('/logout')&#125;"</span>&gt;</span><br><span class="line">      &lt;a ui-sref=<span class="string">"main"</span> logout&gt;Logout&lt;/a&gt;</span><br><span class="line">  &lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<p>Then add the navbar to <strong>public/index.html</strong>:</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="operator">div</span> class=<span class="string">'container'</span>&gt;</span><br><span class="line">   &lt;<span class="operator">div</span> ng-<span class="built_in">include</span>=<span class="string">"'templates/navbar.html'"</span>&gt;&lt;/<span class="operator">div</span>&gt;</span><br><span class="line">   &lt;<span class="operator">div</span> ui-view&gt;&lt;/<span class="operator">div</span>&gt;</span><br><span class="line">&lt;/<span class="operator">div</span>&gt;</span><br></pre></td></tr></table></figure>
<p>Define routes: </p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$stateProvider</span></span><br><span class="line">	.<span class="keyword">state</span>('main', &#123;</span><br><span class="line">		url: <span class="string">"/"</span>,</span><br><span class="line">		templateUrl: <span class="string">"templates/main.html"</span>,</span><br><span class="line">		controller: 'MainCtrl'</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="keyword">state</span>('register', &#123;</span><br><span class="line">		url: <span class="string">"/register"</span>,</span><br><span class="line">		templateUrl: <span class="string">"templates/register.html"</span>,</span><br><span class="line">	&#125;)</span><br><span class="line">	.<span class="keyword">state</span>('login', &#123;</span><br><span class="line">		url: <span class="string">"/login"</span>,</span><br><span class="line">		templateUrl: <span class="string">"templates/login.html"</span>,</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<p>Create the register and login templates.</p>
<p><strong>public/templates/register.html</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-xs-12"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">h3</span>&gt;</span>Registration<span class="tag">&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">hr</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">sp-registration-form</span> <span class="attribute">post-login-state</span>=<span class="value">"main"</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>public/templates/login.html</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-xs-12"</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">h3</span>&gt;</span>Login<span class="tag">&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="title">hr</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">sp-login-form</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>The Stormpath angular library gives us special directives for our login and registration forms.</p>
<h2 id="Create_profile_view">Create profile view</h2><p>Next we will create a profile view and force the user to log in in order to view it. The route looks like:</p>
<figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.<span class="keyword">state</span>('<span class="keyword">profile</span>', &#123;</span><br><span class="line">  url: '/<span class="keyword">profile</span>',</span><br><span class="line">  templateUrl: 'templates/<span class="keyword">profile</span>.html',</span><br><span class="line">  sp: &#123;</span><br><span class="line">    authenticate: true</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>and the template looks like:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-xs-12"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">h3</span>&gt;</span>My Profile<span class="tag">&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">hr</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="title">div</span> <span class="attribute">class</span>=<span class="value">"col-xs-12"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="title">pre</span> <span class="attribute">ng-bind</span>=<span class="value">"user | json"</span>&gt;</span><span class="tag">&lt;/<span class="title">pre</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Here are the <a href="https://github.com/stormpath/stormpath-sdk-angularjs" target="_blank" rel="external">stormpath-angularjs</a> docs. Happy building!</p>
<p>Final <a href="https://github.com/cleechtech/node-angular-stormpath" target="_blank" rel="external">SOURCE CODE</a></p>

            
                

            
        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/Angular/">Angular</a> <a class="tag tag--primary tag--small t-link" href="/tags/Auth/">Auth</a> <a class="tag tag--primary tag--small t-link" href="/tags/MEAN/">MEAN</a> <a class="tag tag--primary tag--small t-link" href="/tags/Nodejs/">Nodejs</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/12/02/Ruby-On-Rails-—-Introduction-for-the-total-n00b/"  data-tooltip="Part 1 - Ruby On Rails for the MEAN stack developer">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/11/29/Code-samples-to-guide-you-through-the-React-ecosystem/" data-tooltip="Code samples to guide you through the React ecosystem">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


        
            <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2015 Connor Leech. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/12/02/Ruby-On-Rails-—-Introduction-for-the-total-n00b/"  data-tooltip="Part 1 - Ruby On Rails for the MEAN stack developer">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2015/11/29/Code-samples-to-guide-you-through-the-React-ecosystem/" data-tooltip="Code samples to guide you through the React ecosystem">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="3">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-google-plus"></i><span class="">Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://cleechtech.github.io/2015/11/30/Handle-authentication-with-Node-Angular-and-Stormpath/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        <!-- Define author's picture -->


    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="http://www.gravatar.com/avatar/88ce5a1f961832585f329292d22451fc?s=110"/>
        
            <h4 id="about-card-name">Connor Leech</h4>
        
            <h5 id="about-card-bio"><p>Javascript developer in the Bay Area</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Proteus Digital Health</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Oakland, CA
            </h5>
        
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/jquery.js" type="text/javascript"></script>
<script src="/assets/js/jquery.fancybox.js" type="text/javascript"></script>
<script src="/assets/js/jquery.fancybox-thumbs.js" type="text/javascript"></script>
<script src="/assets/js/tranquilpeak.js" type="text/javascript"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'cleechtech';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>



</html>
